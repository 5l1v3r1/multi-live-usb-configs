Following config files specify a configuration layout that allows a user to put multiple live distributions on a single usb flashdrive.

INSTALLATION
------------
0. You will need :
- a linux system
- syslinux (preferably 4.xx) installed on your linux system, along with mtools.
- a usb flash drive
- iso files of at least one supported distribution

1. Create a partition on your flashdrive, mark it bootable.
2. If you want to use Hiren's boot cd, format it to fat32, otherwise you can go with ext2/ext3.
3. Install syslinux to the partition

syslinux -i /dev/xxx  (when using fat32)
OR 
extlinux -i /dev/xxx ( When using ext2/ext3 ) 

4. Copy over the config files and splash. You can test now the device, the menu should work but you won't be able to boot anything yet.

4a. you can instead copy the files and splash to /syslinux on the root of the drive, to reduce the clutter.

5. Copy over all .c32 files from your syslinux directory to the root of usb drive. 
Depending on the distribution they may be in /usr/share/syslinux or /usr/lib/syslinux.

5a. similarily as 4a, you can opt to copy *.c32 files into /syslinux to make things cleaner.

6. edit /syslinux.cfg (or /syslinux/syslinux.cfg if you followed 4a.) and remove unnecessary entries.


HOW DO I PUT MY LIVE DISTRIBUTION FILES ON THE USB
--------------------------------------------------
First, you need to unpack the iso image of your livecd. You can use 7zip for that.

For instance, by running "7z x file.iso", or by mounting the iso image and copying out the files. Copying files out of the iso with mc often fails, producing 0 length files (KNOPPIX) or not opening the iso at all (system rescue cd).

Once you extract the contents of the iso image, check the .cfg file for that distribution for further instructions. For example, for Fedora read fedora.cfg file.



WHAT'S THAT UUID ? 
------------------
You might notice that some configuration files contain a phrase UUID=SOMEUUID . You will need to fix that manually.

First issue a command 'blkid' with your usb device plugged in to your computer. You should get something like this

(.....)
/dev/sdc1: UUID="D88E-7075" TYPE="vfat"

Where /dev/sdc1 is the usb device. So the UUID is D88E-7075 . Replace all occurences of SOMEUUID with that value in config files.


non-fat32 filesystems will have more complex UUID's. Don't worry about that, and proceed normally.

Example : 
/dev/sda2: LABEL="boot" UUID="e27288df-82eb-44b3-90d3-32ffd6f8c26b" TYPE="ext3"

WHAT'S THAT LABEL ?
-------------------
some configs specify a SOMELABEL parameter. Replace it with a label of your partition on usb. You can see it in blkid command output, e.g

/dev/sdc1: UUID="D88E-7075" TYPE="vfat" LABEL="MYSUPERUSBPEN"

If your partition does not have a label, you can give it one by doing

tune2fs -L somelabel /dev/sdc1  (ext2/ext3)
dosfslabel /dev/sdc1 somelabel  (fat32)

IT DOES NOT BOOT AT ALL!
------------------------
First of all try with qemu, by doing i
sudo qemu -hda /dev/sdc 

Where /dev/sdc is the usb device. If it boots, it means that syslinux installation is correct, but there might be a problem with your BIOS. 

Qemu treats device as hard disk. That means that it won't expose any issues related to USB booting, it will simply test if your bootloader installation is correct.

* The device must not be mounted when testing with qemu ! Otherwise weird things can happen !*

If it doesn't boot under qemu at all, you messed something up. Try reinstalling syslinux/extlinux on the device. If you are using classic partition layout (not GPT), partition should be marked bootable.

Other things to try :
---------------------
- zero first 1MB of the drive before installing anything on it. And try installing everything again.
	dd if=/dev/zero bs=1M count=1 of=/dev/sdc 

	You can try erasing more, but it's not necessary.

- syslinux and extlinux has -s parameter that installs slower, but more compatible MBR to the device.

- There are alternate MBR bootloaders with syslinux that you can use. 
	In syslinux directory on your system (mentioned earlier) there will be files mbr.bin , mbr_c.bin and mbr_f.bin.

	The _c variant will set the drive bios is booting from as the first harddrive when ctrl is held during bootup, the _f will always do this. 
	This is helpful if somehow BIOS messes up the drive order. This can cause boot problems for syslinux.

- even more alternative mbr's : 
	altmbr.bin will ignore the active (boot) flag on a partition and instead use a specified partition to boot. 

	It needs to be configured by adding a byte with partition number to the end of the file, and then installing it into MBR. 
	e.g 
		echo -ne "\x03" >> altmbr.bin  #to make it use partition #3
		cat altmbr.bin > /dev/sda

	altmbr*.bin file should be 440 bytes long after modification. If it's not, you did something wrong.

	It has similar _c and _f variants as mentioned before.

- the gptmbr is for GPT partition layouts. it also has similar _c and _f variants for troubleshooting.


- configure partition type as FAT16, format it with any syslinux supported filesystem. 
	This helps with some kingston data traveller II 8GB flashdrives. Try this if BIOS takes too long to recognize a device at boot, which makes it not appear in boot menu.

- turn your usb device into fake USB-ZIP device.
	It's possible to setup <=8GB flash to appear as USB-ZIP drive. This is said to greatly improve compatibility with certain BIOS configurations, however it's recommended for =<4GB devices, somewhat risky for 8GB devices, and probably impossible for >8GB devices.

	More info on it is here : http://www.knoppix.net/wiki/Bootable_USB_Key#Large_USB_keys . It basically uses mkdiskimage command from syslinux package.

- if all else fails, you can use grub2 or other bootloader (plopbt or something else). Grub2 doesn't have some advantages of syslinux, and requires rewriting config files. It's sometimes more compatible on certain hardware configurations (e.g. older intel motherboards).
	You could try to chainload syslinux from grub2, that could work (untested). It's possible to do the reverse thing (hiren menu has such an option)
